---
icon: 
expanded: false
label: Консенсус
order: 960
---
# Консенсус

Операционная система UNICORE работает на выделенных серверах под управлением сообщества. Каждая операционная система UNICORE обладает системным цифровым договором, который определяет высокоуровневые правила работы всей системы, единые для всех центров. 

Каждый желающий может запустить копию операционной системы UNICORE, получив всю информацию о действиях партнёров, но не каждый желающий может принять участие в производстве цепочки блоков. Те люди, у кого на серверах исполняется программное обеспечение операционной системы UNICORE, и которые участвуют в формировании единой для всех цепочки событий называется - производители.

Производители - это выборные технические наблюдатели, которые обеспечивают непрерывное производство цепочки блоков истории действий партнёров. Именно их историю действий вся система и все участники принимают как достоверную. Процесс, в котором производители раз в половину секунды автоматически договариваются о новой достоверной версии сети - называется консенсус.

По-умолчанию в социальной операционной системе UNICORE - 21 основной производитель и неограниченное количество резервных, которые в любой момент готовы заменить любого основного производителя, если тот вышел из строя или стал вредить системе. Минимальное количество производителей, необходимое для работы системы - 1.

Правила консенсуса описаны в системном цифровом договоре и могут изменяться сообществом методом выбора тех производителей, которые поддерживают изменения. При условии набора 80% голосов основных производителей, поддерживающих изменение, системный цифровой договор может быть обновлен на работу по новым правилам. 

Каждый производитель получает вознаграждение за свою деятельность в системном ассете. Процесс, условия и величина вознаграждения может сильно отличаться в каждой версии социальной операционной системы UNICORE, а в некоторых, и вообще отсутствовать. 

Операционная система UNICORE может работать как в децентрализованном режиме, когда обновление системного договора требует создания договоренности между производителями (или их замены сообществом, если договориться невозможно), и в централизованном режиме, когда один производитель (например, владелец бизнеса, использующего выделенную копию UNICORE) единолично изменяет любые правила в своей системе.

Права управления любым цифровым договором могут быть переданы совету производителей операционной системы UNICORE. В этом случае, никто не может изменить программный код цифрового договора без достижения 80% консенсуса основных производителей по этому вопросу.

## DPoS
UNICORE используют делегированное доказательство доли (DPoS) для выбора активных производителей, которые будут уполномочены подписывать блоки в сети. Однако это только половина процесса консенсуса. Другая половина участвует в фактическом процессе подтверждения каждого блока до тех пор, пока он не станет окончательным (необратимым), который выполняется асинхронным византийским отказоустойчивым способом. Таким образом, в модели консенсуса задействованы два уровня:
- Базовый протокол консенсуса
- делегированное доказательство долей (DPoS)

Модель консенсуса на уровне протокола, используемая в UNICORE, не имеет концепции делегирования/голосования, ставок или даже ассетов. Они используются уровнем DPoS для создания и обновления расписания производителей блоков. Эти два уровня функционально разделены в программном обеспечении UNICORE.

## Базовый протокол консенсуса
Протокол решает, какие блоки, полученные и синхронизированные между выбранными производителями, станут окончательными и, следовательно, навсегда останутся в блокчейне. Протокол получает список производителей, предложенный вторым уровнем, и использует это расписание, чтобы определить, какие блоки правильно подписаны соответствующим производителем. 

Для византийской отказоустойчивости уровень использует двухэтапный процесс подтверждения блока, при котором подавляющее большинство в две трети производителей подтверждают каждый блок дважды. На первом этапе подтверждения предлагается последний необратимый блок. Второй этап подтверждает предложенный необратимый блок как окончательный. В этот момент блок становится необратимым. 

## Алгоритмическая завершенность
Модель консенсуса UNICORE достигает алгоритмической завершенности (в отличие от просто вероятностной окончательности, которая в лучшем случае может быть достигнута в моделях Proof of Work) за счет подписей от выбранного набора специальных участников (активных производителей), которые расположены в расписании, чтобы определить, какой производитель авторизован для подписания блока в определенный ему временной интервал. 

Изменения в этом расписании могут быть инициированы привилегированными цифровыми договорами, работающими в блокчейне UNICORE, но любые инициированные изменения в расписании не вступают в силу до тех пор, пока блок, инициировавший изменение расписания, не будет завершен двумя этапами подтверждений. Каждый этап подтверждений выполняется квалифицированным большинством производителей из текущего запланированного набора активных производителей.

## Делегированное доказательство долей (DPoS)
Слой DPoS вводит концепции токенов, ставок, голосования/проксирования, ослабления голосов, подсчета голосов, рейтинга производителей и выплаты им. Этот уровень также отвечает за создание новых расписаний производителей на основе рейтингов, полученных в результате голосования производителей. Это происходит в раундах расписания примерно по две минуты (126 секунд). Временной интервал длится в общей сложности 6 секунд для каждого производителя, что является раундом производителя, в котором может быть создано и подписано максимум 12 блоков. Уровень DPoS определяется системным цифровым договором.

## Заинтересованные стороны и производители
Фактический выбор активных производителей (график производителей) открыт для голосования в каждом раунде расписания, и в нем участвуют все заинтересованные стороны, которые реализуют свое право на участие. Кроме того, каждый производитель опционально может обладать своим центром и цифровой экономикой типа "Двойная Спираль", финансовой оборот которой, создаёт дополнительные очки в рейтинге производителей блоков. Таким образом, рейтинг производителей определяется не только лишь голосованием, но и фактическим участием сообщества в поддержке именно их центра. 

## Процесс консенсуса
Процесс консенсуса UNICORE состоит из двух частей:
- Голосование/планирование производителя — выполняется вторым уровнем консенсуса.
- Производство/проверка блоков — выполняется базовым протоколом консенсуса.

Эти два процесса независимы и могут выполняться параллельно, за исключением самого первого раунда расписания после последовательности загрузки, когда создается первый блок генезиса блокчейна.


## Голосование/расписание производителей
Голосование активных производителей для включения в следующее расписание осуществляется на уровне DPoS. Строго говоря, держатель токена должен заложить несколько токенов в ресурсы CPU/NET своей учётной записи, чтобы стать партнёром, и таким образом, получить возможность голосовать с заданной долей участия.

## Процесс голосования
Каждый партнёр UNICORE может проголосовать за 30 производителей блоков за одно голосование. Затем 21 избранный производитель будет выступать в качестве производителей DPoS для создания и подписания блоков от имени всех партнёров. Остальные производители помещаются в резервный список в порядке получения голосов. Процесс голосования повторяется в каждом раунде расписания путем суммирования количества голосов, полученных каждым производителем. 

## Вес голосования
Вес голоса каждого партнёра вычисляется как функция количества заложенных токенов и времени, прошедшего с момента запуска блокчейна UNICORE. Вес голоса меняется еженедельно и удваивается каждый год при одинаковом количестве поставленных токенов. Таким образом, чем раньше и чем больше токенов заложено партнёром в свои ресурсы, тем больше вес голоса в управлении списком производителей.

## Оборот двойных спиралей
Оборот двойной спирали каждого производителя в отдельности влияет на количество полученных ими голосов. Чем выше оборот в двойной спирали производителя, тем большее количество новых голосов он получает. Таким образом, наиболее эффективные прозводители это те, которые обладают наибольшим активным сообществом в своём центре. 

## График производителей
После того, как производители выбраны для следующего расписания, они сортируются в алфавитном порядке по имени учётной записи. Это определяет порядок производства блоков. 
